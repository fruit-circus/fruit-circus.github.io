<!DOCTYPE html>
<html>
<head>
<style>
.pointer {
  cursor: pointer;
}
.room{
    position: absolute;
}
.butt{
    z-index: 5;
    transform: translate(100px, 100px);
}

.dialogue{
    display: none;
    position: absolute;
}

#kodaly{
    display: block;
}

.text {
    position: absolute;
    transform: translate(400px, 550px);
    max-width: 900px;
    height: 100px;
    font-size: 25px;
}


#p2,
#p3,
#p4,
#p5,
#p6,
#p7,
#p8,
#p9,
#p10,
#p11,
#p12,
#p13,
#p14,
#p15,
#p16
 {
    display: none;
}



.entryform{
    display: none;
    z-index: 8;
    position: absolute;
    border: 1px solid black;
    transform: translate(800px, 100px);
}

#inv{
    display: none;
    z-index: 2;
}

#book,
#bookbody{
    display: none;
    z-index: 6;
}

.pagetext{
    position: absolute;
}
.left{
    transform: translate(400px, 100px);
    position: absolute;
    width: 300px;
    z-index: 9;
}
.right{
    transform: translate(800px, 100px);
    position: absolute;
    width: 300px;
    z-index: 9;
}

#page1,
#page2,
#page3,
#page4,
#page5,
#page6,
#page7,
#page8,
#page9,
#page10,
#page11,
#page12
 {
    display: none;

}

.arrow{
    display: none;
    z-index: 7;
    position: absolute;
}

#baseroom{
    z-index: -1;
}

.invFlex {
    display: flex;
    z-index: 4;
    width: 500px;
    margin-left: auto;
    margin-right: auto;
    position: relative;
    transform: translateY(200px);

}

#invContent1,
#invContent2,
#invContent3 {
    z-index: 3;
    display: none;
    font-family: -apple-system;
}

</style>
</head>
<body>

        <div> <!--Inventory-->
            <img src="satchel.png" alt="satchel" usemap="#roommap" class="room" id="satchel">
            <img src="inv.png" alt="inv" usemap="#invmap" class="room" id="inv">
        </div>

        <div> <!--This is the guest book. To write an entry, enter your message and alias on the form and hit "submit." To view other guests' entries, hit the right arrow. -->
            <img src="guestbook.png" alt="book" usemap="#bookmap" class="room" id="book">
            <img src="guestbookbody.png" alt="book" usemap="#bookmap" class="room" id="bookbody">
            <img src="nextarrow.png" alt="arrow" usemap="#bookmap" class="arrow" id="nextarrow">
            <img src="prevarrow.png" alt="arrow" usemap="#bookmap" class="arrow" id="prevarrow">
            <div class="pagetext">
                <div class="left">
                    <p id="page1">This is the 1st entry.</p>
                    <p id="page3">This is the 3rd entry.</p>
                    <p id="page5">This is the 5th entry.</p>
                    <p id="page7">This is the 7th entry.</p>
                    <p id="page9">This is the 9th entry.</p>
                    <p id="page11">This is the 11th entry.</p>
                </div>
                <div class="right">
                    <p id="page2">This is the 2nd entry.</p>
                    <p id="page4">This is the 4th entry.</p>
                    <p id="page6">This is the 6th entry.</p>
                    <p id="page8">This is the 8th entry.</p>
                    <p id="page10">This is the 10th entry.</p>
                    <p id="page12">This is the 12th entry.</p>
                </div>
            </div>
        </div>

        <div> <!--The Lobby-->
            <img src="basicroom.gif" alt="lobby" usemap="#roommap" class="room" id="baseroom">
            <img src="plinth.png" alt="plinth" usemap="#roommap" class="room">
            <img src="rope.png" alt="rope" usemap="#roommap" class="room" id="rope">
            <img src="keya.png" alt="key" usemap="#roommap" class="room" id="keya">
            <img src="sword.png" alt="sword" usemap="#roommap" class="room" id="sword">
        </div>


    <!--Maps-->
    <map name="roommap"> <!--Object Positions-->
        <area shape="rect" coords="7,650,160,770" alt="inventory" class="pointer" onclick="showInv()">
        <area shape="rect" coords="261,193,424,351" alt="western door" class="pointer" onclick="toRoom2()">
        <area shape="rect" coords="767,87,912,242" alt="northern door" class="pointer" id="north">
        <area shape="circle" coords="368,454,60" alt="rope" class="pointer" onclick="pickRope()">
        <area shape="rect" coords="484,48,623,275" alt="plinth" class="pointer" onclick="openGuestBook()">
        <area shape="rect" coords="960,145,1151,240" alt="sword" class="pointer" onclick="pickSword()">
        <area shape="rect" coords="680,575,800,695" alt="key" class="pointer" onclick="pickKeyA()">
        <area shape="rect" coords="550,260,800,474" alt="explorers" class="pointer" onclick="dialogue()">
    </map>

    <map name="invmap"> <!--Inventory-->
        <area shape="rect" coords="1008,35,1111,133" alt="close" class="pointer" onclick="hideInv()">
        <area shape="rect" coords="7,650,160,770" alt="close" class="pointer" onclick="hideInv()">
    </map>

    <map name="bookmap"> <!--Guest Book-->
        <area shape="rect" coords="42,15,140,110" alt="close" class="pointer" onclick="hideGuestBook()">
        <area shape="rect" coords="63,333,177,415" alt="prev" class="pointer" onclick="prevPage()">
        <area shape="rect" coords="1280,350,1400,420" alt="next" class="pointer" onclick="nextPage()">
    </map>

    <div class="entryform" id="entryform">
        <form action="https://formspree.io/f/mdknkobd" method="POST">                   
        <textarea for="comments" style="width:410px; height:100px;" id="comments" name="comments"></textarea><br><br>
        <input type="text" id="alias" name="alias"><br><br>
        <input type="submit" value="Submit">
        </form>
    </div>

<!--Audio-->
<audio id="click1"><source src="sound.m4a" type="audio/mpeg"></audio>
<audio id="fullInv"><source src="sound2.m4a" type="audio/mpeg"></audio>
<audio id="penser" src="penser.mp3" autoplay loop></audio>
  
<!--Restart Button-->
<button class="butt" onclick="deleteCookies()">Restart</button>

<div> <!--Dialogue Boxes-->
    <img src="kodaly.png" alt="kodaly's default dialogue portrait" class="dialogue" id="kodaly">
    <img src="bridget.png" alt="bridget's default dialogue portrait" class="dialogue" id="bridget">
    <img src="stymie.png" alt="stymie's default dialogue portrait" class="dialogue" id="stymie">
    <img src="virelai.png" alt="virelai's default dialogue portrait" class="dialogue" id="virelai">
    <img src="shuri.png" alt="shuri's default dialogue portrait" class="dialogue" id="shuri">
</div>

<div class="text"> <!--Dialogue-->
    <p id="p1">Alright! We made it!</p>
    <p id="p2">After about four hours of mucking about in the Zoza City sewer system.</p>
    <p id="p3">This place is incredible. The soldiers weren't kidding... It almost feels like the room is alive.</p>
    <p id="p4">Hello!</p>
    <p id="p5">Gwah! Who was that?!</p>
    <p id="p6">The room!</p>
    <p id="p7">OMG.</p>
    <p id="p8">Just kidding!</p>
    <p id="p9">I'm Disparate Fragment STMI, but you can call me Stymie! I know lots of things about the Labyrinth, so you can talk to me if you ever have any questions.</p>
    <p id="p10">We'll definitely take you up on that.</p>
    <p id="p11">Does STMI stand for something?</p>
    <p id="p12">STMI is short for "System that Misrepresents Information."</p>
    <p id="p13">Or was it "System that <i>Misinterprets</i> Information..."</p>
    <p id="p14">In any case, I'm happy to help if you get stuck.</p>
</div>

               

                <div class="invFlex"> <!--Replace This with images-->
                <p id="invContent1"></p><br>
                <p id="invContent2"></p><br>
                <p id="invContent3"></p><br>
                </div>

    

<script>
    //audio
    var click1Audio = document.getElementById("click1");
    var fullInv = document.getElementById("fullInv");
    //lobby
    var rope = document.getElementById("rope");
    var sword = document.getElementById("sword");
    var keya = document.getElementById("keya");
    //inventory
    var inv = document.getElementById("inv");
    //guest book
    var frontMatter = document.getElementById("book");
    var bookBody = document.getElementById("bookbody");
    var prevarrow = document.getElementById("prevarrow");
    var nextarrow = document.getElementById("nextarrow");
    var entryform = document.getElementById("entryform");
    //pages in the lobby guest book
    var page1 = document.getElementById("page1");
    var page2 = document.getElementById("page2");
    var page3 = document.getElementById("page3");
    var page4 = document.getElementById("page4");
    var page5 = document.getElementById("page5");
    var page6 = document.getElementById("page6");
    var page7 = document.getElementById("page7");
    var page8 = document.getElementById("page8");
    var page9 = document.getElementById("page9");
    var page10 = document.getElementById("page10");
    var page11 = document.getElementById("page11");
    var page12 = document.getElementById("page12");
    //intro dialogue text
    var p1 = document.getElementById("p1");
    var p2 = document.getElementById("p2");
    var p3 = document.getElementById("p3");
    var p4 = document.getElementById("p4");
    var p5 = document.getElementById("p5");
    var p6 = document.getElementById("p6");
    var p7 = document.getElementById("p7");
    var p8 = document.getElementById("p8");
    var p9 = document.getElementById("p9");
    var p10 = document.getElementById("p10");
    var p11 = document.getElementById("p11");
    var p12 = document.getElementById("p12");
    var p13 = document.getElementById("p13");
    var p14 = document.getElementById("p14");
    //dialogue boxes
    var k = document.getElementById("kodaly");
    var b = document.getElementById("bridget");
    var st = document.getElementById("stymie");


    const invitems = {
        slot1: false,
        slot2: false,
        slot3: false,
    } //are these necessary? could we just check cookies? they might not be hurting anything on the other hand

     const key = {
        a: false,
    }

document.addEventListener("DOMContentLoaded", (event) => {   
    var audio = document.getElementById('penser');
    audio.play(); 

    if (checkCookie('slot_1')) {
        invitems.slot1 = true;        
    }
    if (checkCookie('slot_2')) {
        invitems.slot2 = true;        
    }
    if (checkCookie('slot_3')) {
        invitems.slot3 = true;        
    }
    if (checkCookieValue('sword')) {
    console.log('Sword is in inventory.');
    sword.style.display = "none";
}
    if (checkCookieValue('rope')) {
    console.log('Rope is in inventory.');
    rope.style.display = "none";
}
    if (checkCookieValue('keya')) {
    console.log('Key.a is in inventory.');
    keya.style.display = "none";
    key.a = "true"; }});

    function checkCookie(name) {
    let cookies = document.cookie.split(';');
    return cookies.some(cookie => cookie.trim().startsWith(name + '='));}
    function checkCookieValue(value) { //check for a sword or key, e.g.
    let cookies = document.cookie.split(';');
    return cookies.some(cookie => cookie.trim().split('=')[1] === value);}
    function getCookie(name) {
    let value = "; " + document.cookie;
    let parts = value.split("; " + name + "=");
    if (parts.length == 2) return parts.pop().split(";").shift();}
    function deleteCookies() { //reload and refresh entirely
    document.cookie.split(';').forEach(cookie => {
    const eqPos = cookie.indexOf('=');
    const name = eqPos > -1 ? cookie.substring(0, eqPos) : cookie;
    document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT';});
    location.reload()}


   function showInv() {
        inv.style.display = "block";
        click1Audio.play();
        if (invitems.slot1) {
        document.getElementById('invContent1').innerText = getCookie('slot_1');
        invContent1.style.display = "block";}
        if (invitems.slot2) {
        document.getElementById('invContent2').innerText = getCookie('slot_2');
        invContent2.style.display = "block";}
        if (invitems.slot3) {
        document.getElementById('invContent3').innerText = getCookie('slot_3');
        invContent3.style.display = "block";}}

   function hideInv() {
        inv.style.display = "none";
        invContent1.style.display = "none";
        invContent2.style.display = "none";
        invContent3.style.display = "none";
        click1Audio.play();}

//guest book navigation
const page = {spread: 0,}

 function openGuestBook() {
    frontMatter.style.display = "block";
    nextarrow.style.display = "block";
    entryform.style.display = "block";
    click1Audio.play();}

 function hideGuestBook() {
    frontMatter.style.display = "none";
    bookBody.style.display = "none";
    nextarrow.style.display = "none";
    prevarrow.style.display = "none";
    entryform.style.display = "none";
    page1.style.display = "none";
    page2.style.display = "none";
    page3.style.display = "none";
    page4.style.display = "none";
    page5.style.display = "none";
    page6.style.display = "none";
    page7.style.display = "none";
    page8.style.display = "none";
    page9.style.display = "none";
    page10.style.display = "none";
    page11.style.display = "none";
    page12.style.display = "none";
    click1Audio.play();}

 function nextPage() {
    prevarrow.style.display = "block";
    frontMatter.style.display = "none";
    bookBody.style.display = "block";
    entryform.style.display = "none";
    click1Audio.play();
    if (typeof page.spread === 'undefined') {
        page.spread = 0;
    }
    switch (page.spread) {
        case 0:
            page1.style.display = "block";
            page2.style.display = "block";
            page.spread = 1;
            break;
        case 1:
            page1.style.display = "none";
            page2.style.display = "none";
            page3.style.display = "block";
            page4.style.display = "block";
            page.spread = 2;
            break;
        case 2:
            page3.style.display = "none";
            page4.style.display = "none";
            page5.style.display = "block";
            page6.style.display = "block";
            page.spread = 3;
            break;
        case 3:
            page5.style.display = "none";
            page6.style.display = "none";
            page7.style.display = "block";
            page8.style.display = "block";
            page.spread = 4;
            break;
        case 4:
            page7.style.display = "none";
            page8.style.display = "none";
            page9.style.display = "block";
            page10.style.display = "block";
            page.spread = 5;
            break;
        case 5:
            page9.style.display = "none";
            page10.style.display = "none";
            page11.style.display = "block";
            page12.style.display = "block";
            nextarrow.style.display = "none"; //add more cases here if 12 pages prooves insufficient
            page.spread = 6;
            break;
        default:
        console.log("Dats da end'a da book baby");
    }
}

 function prevPage() {
    nextarrow.style.display = "block";
    click1Audio.play();
    if (typeof page.spread === 'undefined') {
        page.spread = 0;
    }
    switch (page.spread) {
        case 0:
            page.spread = 0;
            break;
        case 1:
            page1.style.display = "none";
            page2.style.display = "none";
            frontMatter.style.display = "block";
            nextarrow.style.display = "block";
            entryform.style.display = "block";
            bookBody.style.display = "none";
            page.spread = 0;
            break;
        case 2:
            page3.style.display = "none";
            page4.style.display = "none";
            page1.style.display = "block";
            page2.style.display = "block";
            page.spread = 1;
            break;
        case 3:
            page5.style.display = "none";
            page6.style.display = "none";
            page4.style.display = "block";
            page3.style.display = "block";
            page.spread = 2;
            break;
        case 4:
            page7.style.display = "none";
            page8.style.display = "none";
            page6.style.display = "block";
            page5.style.display = "block";
            page.spread = 3;
            break;
        case 5:
            page9.style.display = "none";
            page10.style.display = "none";
            page7.style.display = "block";
            page8.style.display = "block";
            page.spread = 4;
            break;
        case 6:
            page9.style.display = "block";
            page10.style.display = "block";
            page11.style.display = "none";
            page12.style.display = "none";
            page.spread = 5;
            break;
        default:
        console.log("Dats da front'a da book, baby");
    }
}



    document.addEventListener("keydown", function() {
        if (event.key === 'Enter' || event.key === ' ') {
        p1.style.display = "none";
        p2.style.display = "block";
    }
    document.addEventListener("keydown", function() {
        if (event.key === 'Enter' || event.key === ' ') {

            p2.style.display = "none";
            p3.style.display = "block";
            b.style.display = "block";
            k.style.display = "none";
        }
            document.addEventListener("keydown", function() {
                if (event.key === 'Enter' || event.key === ' ') {

                p3.style.display = "none";
                p4.style.display = "block";
                b.style.display = "none";
                st.style.display = "block";
            }
                document.addEventListener("keydown", function() {
                    if (event.key === 'Enter' || event.key === ' ') {

                    p4.style.display = "none";
                    p5.style.display = "block";
                    b.style.display = "block";
                    st.style.display = "none";
                }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p5.style.display = "none";
                    p6.style.display = "block";
                    st.style.display = "block";
                    b.style.display = "none";
                }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p6.style.display = "none";
                    p7.style.display = "block";
                    b.style.display = "block"; //omg!
                    st.style.display = "none"; 
                        }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p7.style.display = "none";
                    p8.style.display = "block";
                    st.style.display = "block";
                    b.style.display = "none";
                        }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p8.style.display = "none";
                    p9.style.display = "block";
                    st.style.display = "block";
                        }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p9.style.display = "none";
                    p10.style.display = "block";
                    k.style.display = "block"; //we'll take you up on that
                    st.style.display = "none";
                        }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p10.style.display = "none";
                    p11.style.display = "block";
                    b.style.display = "block";
                    k.style.display = "none";
                        }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p11.style.display = "none";
                    p12.style.display = "block";
                    st.style.display = "block";
                    b.style.display = "none";
                    }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p12.style.display = "none";
                    p13.style.display = "block";
                    }
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p13.style.display = "none";
                    p14.style.display = "block";
                    }
    
                   
                    document.addEventListener("keydown", function() {
                        if (event.key === 'Enter' || event.key === ' ') {

                    p14.style.display = "none";
                    st.style.display = "none";

                    }
                   
});
});
});        
});
});
});
});
});
});
});
});
});
});
});
//the number of these must equal the number of document.addEventListener("keydown", function() {


    //travelling between rooms
    function toRoom2() {
        if (key.a){
        document.cookie = "room=2;"; //this might be too much, we'll see. DOM content would have to check this every time
        click1Audio.play();
        alert("yay");
        //room2.style.display = "block"; //add this
        //alltheothershit.style.display = "none"; //add these. how to hide all other objects (but for the satchel) and not the destination object.
        }
        else {
            alert("looks like we need a key");
        }
    };


    //add objects to the inventory
    function pickRope() {
      if (checkCookieValue('rope')){
        console.log('You already have this item.');}
      else {if (checkCookie('slot_1')) {
            if (checkCookie('slot_2')) {
            if (checkCookie('slot_3')) {
                    alert("your shit's full") //change
                    fullInv.play();}
                else {document.cookie = "slot_3=rope;";
                rope.style.display = "none";
                invitems.slot3 = true;
                click1Audio.play();}}
            else {document.cookie = "slot_2=rope;";
                rope.style.display = "none";
                invitems.slot2 = true;
                click1Audio.play();}}
        else {document.cookie = "slot_1=rope;";
            rope.style.display = "none";
            invitems.slot1 = true;
            click1Audio.play();}}}

 function pickKeyA() {
      if (checkCookieValue('keya')){
          console.log('You already have this item.');
      }else{
        if (checkCookie('slot_1')) {
            if (checkCookie('slot_2')) {
                if (checkCookie('slot_3')) {
                    alert("your shit's full") //change
                    fullInv.play();}
                else {document.cookie = "slot_3=keya;";
                keya.style.display = "none";
                invitems.slot3 = true; //are these necessary? could we just check cookies? they might not be hurting anything on the other hand
                key.a = true;
                click1Audio.play();}}
            else {document.cookie = "slot_2=keya;";
            keya.style.display = "none";
                invitems.slot2 = true;
                key.a = true;
                click1Audio.play();}}
        else {document.cookie = "slot_1=keya;";
        keya.style.display = "none";
            invitems.slot1 = true;
            key.a = true;
            click1Audio.play();}}}

function pickSword() {
    if (checkCookieValue('sword')){
        console.log('You already have this item.');
    } else {
        if (checkCookie('slot_1')) {
            if (checkCookie('slot_2')) {
                if (checkCookie('slot_3')) {
                    alert("your shit's full")
                    fullInv.play();}
                else {document.cookie = "slot_3=sword;";
                sword.style.display = "none";
                invitems.slot3 = true;
                click1Audio.play();}}
            else {document.cookie = "slot_2=sword;";
                sword.style.display = "none";
                invitems.slot2 = true;
                click1Audio.play();}}
        else {document.cookie = "slot_1=sword;";
            sword.style.display = "none";
            invitems.slot1 = true;
            click1Audio.play();}}}


</script>

<!--
    Cookie “slot_1” does not have a proper “SameSite” attribute value. Soon, cookies without the “SameSite” attribute or with an invalid value will be treated as “Lax”. This means that the cookie will no longer be sent in third-party contexts. If your application depends on this cookie being available in such contexts, please add the “SameSite=None“ attribute to it. To know more about the “SameSite“ attribute, read https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie/SameSite

    Jeno Kodaly: Magpie, they / them.
    Excitable and clever. 
    Likes: bugs, music, map-making.

    Bridget Wong (myself): Goliath Frog, she / her.
    A researcher from the ___ Institute for the ____
    I am shy and cautious.
    Likes: tea and honey, shrubs.

    Cant STMI (System that Misrepresents Information, Cantus): Computer/thing, she / her.
    Stymie seems to be a fragment of the Labyrinth's consciousness that somehow integrated
    with one of the abandoned military computers. Lives in the Lobby, but could probably move
    to a new terminal or exist in multiple places if she wanted. Very talkative. It seems like
    she only knows what's going on in the lobby + the area immediately around it. She's definitely
    hiding something, but I don't think she knows anything more than we do about
    the purpose of the Labyrinth. 

    Summer Virelai: Mouse, she / her.
    Very polite and helpful towards Kodaly and me so far, but definitely up to something. Not sure if what
    she's up to is no good or just something, but I'm not sure I'll like it when we find out. Summer is
    a fairly small, white and grey mouse. She wears a black skirt and turtleneck with the sleeves cut off.
    Violet earrings and an emerald / brass ring on her left hand.
    Very tech-oriented. Handheld computer that I'm not sure the use of.
    She's made a camp in room 4 (see Kodaly's map). Hastily covered up what she's doing
    a few times when we entered the room.

    Shuri: Stoat or a weasel. he/him (presumably). Very large and intimidating. Deep black fur
    and green eyes. Prominent scar across his eye, where he wears an eyepatch. His right ear is cut
    in two places. Leather armor, black cloak, silver sword. I assume he's former military or a
    mercinary of some kind. Not sure where he's camped out, but it must be deeper in, unless he just lurks. 
-->
</body>
</html>